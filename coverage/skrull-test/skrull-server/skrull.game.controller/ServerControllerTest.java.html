<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>ServerControllerTest.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">AllTests (Aug 8, 2012 10:53:56 PM)</a> &gt; <a href="../../index.html" class="el_group">skrull-test</a> &gt; <a href="../index.html" class="el_bundle">skrull-server</a> &gt; <a href="index.html" class="el_package">skrull.game.controller</a> &gt; <span class="el_source">ServerControllerTest.java</span></div><h1>ServerControllerTest.java</h1><pre class="source lang-java linenums">package skrull.game.controller;

import org.easymock.EasyMock;
import org.junit.Before;
import org.junit.Test;

import skrull.game.factory.IGameFactory;
import skrull.game.factory.IGameFactory.GameType;
import skrull.game.model.IPlayer;
import skrull.game.view.IClientAction;
import skrull.game.view.IClientAction.ActionType;

<span class="fc" id="L13">public class ServerControllerTest {</span>

<span class="fc" id="L15">	private static final Integer GAME_ID =  IGameFactory.DEFAULT_GAME_ID;</span>
	private ServerController controller;
	private IGameFactory gameFactory;
	private IClientAction action;
	private IGameController gameController;
	private IGameController defaultGameController;

	@Before
	public void setUp() throws Exception {
<span class="fc" id="L24">		gameFactory = EasyMock.createMock(IGameFactory.class);</span>

<span class="fc" id="L26">		action = EasyMock.createNiceMock(IClientAction.class);</span>
<span class="fc" id="L27">		defaultGameController = EasyMock.createNiceMock(IGameController.class);</span>
<span class="fc" id="L28">		gameController = EasyMock.createNiceMock(IGameController.class);</span>
<span class="fc" id="L29">		EasyMock.expect(gameFactory.setupGame(GameType.DEFAULT,null, 0)).andReturn(defaultGameController);</span>

<span class="fc" id="L31">	}</span>

	// need to test all the action types: 		JOIN_SERVER, CREATE_GAME, JOIN_GAME, MOVE, CHAT, QUIT;
	
	
		/** 
		 * this can probably 
		 * serve as a rough template for the other tyes of tests
		 * @throws Exception
		 */
	
	@Test(expected=UnsupportedOperationException.class)
	public void testProcessClientActionCreateGameDefault() throws Exception {
<span class="nc" id="L44">		IPlayer mockPlayer = EasyMock.createNiceMock(IPlayer.class);</span>
<span class="nc" id="L45">		EasyMock.expect(action.getActionType()).andReturn(ActionType.CREATE_GAME).atLeastOnce();</span>
<span class="nc" id="L46">		EasyMock.expect(action.getPlayer()).andReturn(mockPlayer);</span>
<span class="nc" id="L47">		EasyMock.expect(action.getGameType()).andReturn(GameType.DEFAULT).atLeastOnce();</span>

		
<span class="nc" id="L50">		EasyMock.replay(action, gameFactory, defaultGameController);</span>
<span class="nc" id="L51">		controller = new ServerController(gameFactory);</span>
		//controller.addGameController(gameController);
<span class="nc" id="L53">		controller.processClientAction(action);</span>
<span class="nc" id="L54">		EasyMock.verify(action, gameFactory, defaultGameController);</span>

<span class="nc" id="L56">	}</span>
	
		@Test
		public void testProcessClientActionCreateGameSpecific() throws Exception {
<span class="fc" id="L60">			IPlayer mockPlayer = EasyMock.createNiceMock(IPlayer.class);</span>
<span class="fc" id="L61">			EasyMock.expect(action.getActionType()).andReturn(ActionType.CREATE_GAME).atLeastOnce();</span>
<span class="fc" id="L62">			EasyMock.expect(action.getPlayer()).andReturn(mockPlayer);</span>
<span class="fc" id="L63">			EasyMock.expect(action.getGameType()).andReturn(GameType.TIC_TAC_TOE).atLeastOnce();</span>

<span class="fc" id="L65">			EasyMock.expect(gameFactory.setupGame(GameType.TIC_TAC_TOE, mockPlayer, 1)).andReturn(gameController);</span>
			
<span class="fc" id="L67">			gameController.processGameAction(action);</span>
<span class="fc" id="L68">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L70">			EasyMock.replay(action, gameFactory, gameController);</span>
<span class="fc" id="L71">			controller = new ServerController(gameFactory);</span>
<span class="fc" id="L72">			controller.addGameController(gameController);</span>
<span class="fc" id="L73">			controller.processClientAction(action);</span>
<span class="fc" id="L74">			EasyMock.verify(action, gameFactory, gameController);</span>

<span class="fc" id="L76">		}</span>
		
		@Test
		public void testProcessClientActionJoinDefault() throws Exception {


<span class="fc" id="L82">			ActionType t = ActionType.JOIN_GAME;</span>
<span class="fc" id="L83">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			
<span class="fc" id="L85">			EasyMock.expect(action.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L86">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID);</span>
			
<span class="fc" id="L88">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT).atLeastOnce();</span>
<span class="fc" id="L89">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID);</span>


			
<span class="fc" id="L93">			defaultGameController.processGameAction(action);</span>
<span class="fc" id="L94">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L96">			EasyMock.replay(gameFactory, action, defaultGameController);</span>
<span class="fc" id="L97">			controller = new ServerController(gameFactory);</span>
			//controller.addGameController(gameController);
<span class="fc" id="L99">			controller.processClientAction(action);</span>
<span class="fc" id="L100">			EasyMock.verify(gameFactory, action, defaultGameController);</span>
			

<span class="fc" id="L103">		}</span>

		
		@Test
		public void testProcessClientActionJoinSpecific() throws Exception {


<span class="fc" id="L110">			final ActionType t = ActionType.JOIN_GAME;</span>
			
<span class="fc" id="L112">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			
<span class="fc" id="L114">			EasyMock.expect(action.getGameType()).andReturn(GameType.TIC_TAC_TOE).atLeastOnce();</span>
<span class="fc" id="L115">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID + 1).atLeastOnce();</span>
			
<span class="fc" id="L117">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT).anyTimes();</span>
<span class="fc" id="L118">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID).anyTimes();</span>
			
<span class="fc" id="L120">			EasyMock.expect(gameController.getGameType()).andReturn(GameType.TIC_TAC_TOE);</span>
<span class="fc" id="L121">			EasyMock.expect(gameController.getGameId()).andReturn(GAME_ID + 1);</span>
			
			
			


			
<span class="fc" id="L128">			gameController.processGameAction(action);</span>
<span class="fc" id="L129">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L131">			EasyMock.replay(gameController, gameFactory, action, defaultGameController);</span>
<span class="fc" id="L132">			controller = new ServerController(gameFactory);</span>
<span class="fc" id="L133">			controller.addGameController(gameController);</span>
<span class="fc" id="L134">			controller.processClientAction(action);</span>
<span class="fc" id="L135">			EasyMock.verify(gameController, gameFactory, action, defaultGameController);</span>
			

<span class="fc" id="L138">		}</span>
		
		@Test
		public void testProcessClientActionMoveDefault() throws Exception {


<span class="fc" id="L144">			ActionType t = ActionType.MOVE;</span>
<span class="fc" id="L145">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			
<span class="fc" id="L147">			EasyMock.expect(action.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L148">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID);</span>
			
<span class="fc" id="L150">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L151">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID);</span>


			
<span class="fc" id="L155">			defaultGameController.processGameAction(action);</span>
<span class="fc" id="L156">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L158">			EasyMock.replay(gameFactory,action, defaultGameController);</span>
<span class="fc" id="L159">			controller = new ServerController(gameFactory);</span>
			//controller.addGameController(gameController);
<span class="fc" id="L161">			controller.processClientAction(action);</span>
<span class="fc" id="L162">			EasyMock.verify(gameFactory,action, defaultGameController);</span>
			

<span class="fc" id="L165">		}</span>
		
		
		@Test
		public void testProcessClientActionMoveSpecific() throws Exception {


<span class="fc" id="L172">			final ActionType t = ActionType.MOVE;</span>
			
<span class="fc" id="L174">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			
<span class="fc" id="L176">			EasyMock.expect(action.getGameType()).andReturn(GameType.TIC_TAC_TOE).atLeastOnce();</span>
<span class="fc" id="L177">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID + 1).atLeastOnce();</span>
			
<span class="fc" id="L179">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT).anyTimes();</span>
<span class="fc" id="L180">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID).anyTimes();</span>
			
<span class="fc" id="L182">			EasyMock.expect(gameController.getGameType()).andReturn(GameType.TIC_TAC_TOE);</span>
<span class="fc" id="L183">			EasyMock.expect(gameController.getGameId()).andReturn(GAME_ID + 1);</span>
			
			
			


			
<span class="fc" id="L190">			gameController.processGameAction(action);</span>
<span class="fc" id="L191">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L193">			EasyMock.replay(gameController, gameFactory, action, defaultGameController);</span>
<span class="fc" id="L194">			controller = new ServerController(gameFactory);</span>
<span class="fc" id="L195">			controller.addGameController(gameController);</span>
<span class="fc" id="L196">			controller.processClientAction(action);</span>
<span class="fc" id="L197">			EasyMock.verify(gameController, gameFactory, action, defaultGameController);</span>
			

<span class="fc" id="L200">		}</span>
		
		
		@Test
		public void testProcessClientActionChatDefault() throws Exception {


<span class="fc" id="L207">			ActionType t = ActionType.CHAT;</span>
<span class="fc" id="L208">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			
<span class="fc" id="L210">			EasyMock.expect(action.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L211">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID);</span>
			
<span class="fc" id="L213">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L214">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID);</span>


			
<span class="fc" id="L218">			defaultGameController.processGameAction(action);</span>
<span class="fc" id="L219">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L221">			EasyMock.replay(gameFactory, action, defaultGameController);</span>
<span class="fc" id="L222">			controller = new ServerController(gameFactory);</span>
			//controller.addGameController(gameController);
<span class="fc" id="L224">			controller.processClientAction(action);</span>
<span class="fc" id="L225">			EasyMock.verify(gameFactory, action, defaultGameController);</span>
			

<span class="fc" id="L228">		}</span>
		
		@Test
		public void testProcessClientActionChatSpecific() throws Exception {


<span class="fc" id="L234">			final ActionType t = ActionType.CHAT;</span>
			
<span class="fc" id="L236">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			
<span class="fc" id="L238">			EasyMock.expect(action.getGameType()).andReturn(GameType.TIC_TAC_TOE).atLeastOnce();</span>
<span class="fc" id="L239">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID + 1).atLeastOnce();</span>
			
<span class="fc" id="L241">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT).anyTimes();</span>
<span class="fc" id="L242">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID).anyTimes();</span>
			
<span class="fc" id="L244">			EasyMock.expect(gameController.getGameType()).andReturn(GameType.TIC_TAC_TOE);</span>
<span class="fc" id="L245">			EasyMock.expect(gameController.getGameId()).andReturn(GAME_ID + 1);</span>
			
			
			


			
<span class="fc" id="L252">			gameController.processGameAction(action);</span>
<span class="fc" id="L253">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L255">			EasyMock.replay(gameController, gameFactory, action, defaultGameController);</span>
<span class="fc" id="L256">			controller = new ServerController(gameFactory);</span>
<span class="fc" id="L257">			controller.addGameController(gameController);</span>
<span class="fc" id="L258">			controller.processClientAction(action);</span>
<span class="fc" id="L259">			EasyMock.verify(gameController, gameFactory, action, defaultGameController);</span>
			

<span class="fc" id="L262">		}</span>
		
		
		@Test
		public void testProcessClientActionQuitDefault() throws Exception {


<span class="fc" id="L269">			ActionType t = ActionType.QUIT;</span>
<span class="fc" id="L270">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			
<span class="fc" id="L272">			EasyMock.expect(action.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L273">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID);</span>
			
<span class="fc" id="L275">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L276">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID);</span>


			
<span class="fc" id="L280">			defaultGameController.processGameAction(action);</span>
<span class="fc" id="L281">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L283">			EasyMock.replay(gameFactory, action, defaultGameController);</span>
<span class="fc" id="L284">			controller = new ServerController(gameFactory);</span>
<span class="fc" id="L285">			controller.addGameController(gameController);</span>
<span class="fc" id="L286">			controller.processClientAction(action);</span>
<span class="fc" id="L287">			EasyMock.verify(gameFactory, action, defaultGameController);</span>
			

<span class="fc" id="L290">		}</span>
		
		@Test
		public void testProcessClientActionQuitSpecific() throws Exception {


<span class="fc" id="L296">			final ActionType t = ActionType.QUIT;</span>
			
<span class="fc" id="L298">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			
<span class="fc" id="L300">			EasyMock.expect(action.getGameType()).andReturn(GameType.TIC_TAC_TOE).atLeastOnce();</span>
<span class="fc" id="L301">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID + 1).atLeastOnce();</span>
			
<span class="fc" id="L303">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT).anyTimes();</span>
<span class="fc" id="L304">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID).anyTimes();</span>
			
<span class="fc" id="L306">			EasyMock.expect(gameController.getGameType()).andReturn(GameType.TIC_TAC_TOE);</span>
<span class="fc" id="L307">			EasyMock.expect(gameController.getGameId()).andReturn(GAME_ID + 1);</span>
			
			
			


			
<span class="fc" id="L314">			gameController.processGameAction(action);</span>
<span class="fc" id="L315">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L317">			EasyMock.replay(gameController, gameFactory, action, defaultGameController);</span>
<span class="fc" id="L318">			controller = new ServerController(gameFactory);</span>
<span class="fc" id="L319">			controller.addGameController(gameController);</span>
<span class="fc" id="L320">			controller.processClientAction(action);</span>
<span class="fc" id="L321">			EasyMock.verify(gameController, gameFactory, action, defaultGameController);</span>
			

<span class="fc" id="L324">		}</span>
		
		@Test
		public void testProcessClientActionJoinServer() throws Exception {
<span class="fc" id="L328">			final ActionType t = ActionType.JOIN_SERVER;</span>
<span class="fc" id="L329">			EasyMock.expect(action.getActionType()).andReturn(t);</span>
			//EasyMock.expect(gameFactory.listAvailableGames()).andReturn(new String[]{&quot;game1&quot;,&quot;game2&quot;,&quot;game3&quot;});

<span class="fc" id="L332">			defaultGameController.processGameAction(action);</span>
<span class="fc" id="L333">			EasyMock.expectLastCall();</span>
			
<span class="fc" id="L335">			EasyMock.expect(action.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L336">			EasyMock.expect(action.getGameId()).andReturn(GAME_ID);</span>
			
<span class="fc" id="L338">			EasyMock.expect(defaultGameController.getGameType()).andReturn(GameType.DEFAULT);</span>
<span class="fc" id="L339">			EasyMock.expect(defaultGameController.getGameId()).andReturn(GAME_ID);</span>
			
<span class="fc" id="L341">			EasyMock.replay(defaultGameController, action, gameFactory);</span>
<span class="fc" id="L342">			controller = new ServerController(gameFactory);</span>
			//controller.addGameController(gameController);
<span class="fc" id="L344">			controller.processClientAction(action);</span>
<span class="fc" id="L345">			EasyMock.verify(defaultGameController, action, gameFactory);</span>
<span class="fc" id="L346">		}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.5.8.201207111220</span>AllTests (Aug 8, 2012 10:53:56 PM)</div></body></html>